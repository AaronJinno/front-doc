import{_ as n,P as a,Q as s,a5 as t}from"./framework-3728cbf1.js";const p={},e=t(`<h2 id="i-多媒体的四种方法" tabindex="-1"><a class="header-anchor" href="#i-多媒体的四种方法" aria-hidden="true">#</a> Ⅰ. 多媒体的四种方法</h2><h4 id="_1-paly方法" tabindex="-1"><a class="header-anchor" href="#_1-paly方法" aria-hidden="true">#</a> 1. paly方法</h4><p>使用 play 方法来播放媒体，自动将元素的 paused 属性的值变为 false 。</p><h4 id="_2-pause方法" tabindex="-1"><a class="header-anchor" href="#_2-pause方法" aria-hidden="true">#</a> 2. pause方法</h4><p>使用 pause 方法来暂停播放，自动将元素的 paused 属性的值变为 true。</p><h4 id="_3-load方法" tabindex="-1"><a class="header-anchor" href="#_3-load方法" aria-hidden="true">#</a> 3. load方法</h4><p>重新载入媒体进行播放，自动将元素的 playbackRate 属性的值变为defaultPlaybackRate 属性的值，自动将元素的 error 的值变为 null 。可以从新加载新的视频。</p><h4 id="_4-canplaytype-方法" tabindex="-1"><a class="header-anchor" href="#_4-canplaytype-方法" aria-hidden="true">#</a> 4. canPlayType 方法</h4><p>测试浏览器是否支持指定的媒体类型</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> support <span class="token operator">=</span> videoElement<span class="token punctuation">.</span><span class="token function">canPlayType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>参数type</strong></p><p>该方法使用一个参数 type , 该参数的指定方法与 source 元素的 type 参数的指定方法相同 用播放文件的MIME类型来指定,可以在指定的字符串中加上表示媒体编码格式的 codes 参数。</p><p><strong>参数type的返回值</strong></p><ul><li>空字符串：表示浏览器不支持此种媒体类型。</li><li>maybe：表示浏览器可能支持此种媒体类型。</li><li>probably：表示浏览器确定支持此种媒体类型。</li></ul><h4 id="_5-媒体播放示例" tabindex="-1"><a class="header-anchor" href="#_5-媒体播放示例" aria-hidden="true">#</a> 5. 媒体播放示例</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mvEvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>535px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>source1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>source/mv.mp4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>播放<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>下一个<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> video1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;mvEvent&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oplay <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&#39;span&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//这个标记用来确认按钮到底是执行暂停还是播放，初始化是播放。</span>
  <span class="token comment">//当然也可以不使用标记，而直接判断video.paused的值。</span>
  <span class="token keyword">function</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        video1<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        oplay<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;暂停&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        video1<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        oplay<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;播放&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>       
<span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> source1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&#39;source1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    source1<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;source/风.mp4&quot;</span><span class="token punctuation">;</span>       
    video1<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//重新初始化播放按钮和标记</span>
    oplay<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;播放&quot;</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ii-事件" tabindex="-1"><a class="header-anchor" href="#ii-事件" aria-hidden="true">#</a> Ⅱ. 事件</h2><p>读取或播放媒体数据的时候，会触发一系列的事件，如果用 JavaScript 脚本来捕捉这些事件，就可以对这些事件进行处理了。对于这些事件的捕捉及其处理，可以按两种方式进行。</p><h4 id="_1-监听方式" tabindex="-1"><a class="header-anchor" href="#_1-监听方式" aria-hidden="true">#</a> 1. 监听方式</h4><p>使用 video 元素或 audio 元素的 addEventListener 方法来对事件的发生进行监听。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>videoElement<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>listener<span class="token punctuation">,</span>useCapture<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>videoElement 表示页面上的 video 元素或 audio 元素</li><li>type 为事件名称</li><li>listener 表示绑定的函数</li><li>useCapture 是一个布尔值，表示该事件的响应顺序， <ul><li>true：浏览器采用 Capture 响应方式，</li><li>false：浏览器采用 bubbing 响应方式，一般采用false，默认情况下也为false。</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>video<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">(</span>中略<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-第二种获取事件句柄方式" tabindex="-1"><a class="header-anchor" href="#_2-第二种获取事件句柄方式" aria-hidden="true">#</a> 2. 第二种获取事件句柄方式</h4><p>第二种事件处理方式为 JavaScript 脚本中常见的获取事件句柄的方式</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videol<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sample.mov<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>begin_playing();<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">function</span> <span class="token function">begin_playing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">(</span>中略<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-具体事件介绍" tabindex="-1"><a class="header-anchor" href="#_3-具体事件介绍" aria-hidden="true">#</a> 3. 具体事件介绍</h4><p>浏览器在请求媒体数据、下载媒体数据、播放媒体数据一直到播放结束这一系列过程中，所触发的所有事件如下：</p><table><thead><tr><th style="text-align:center;">方法名</th><th style="text-align:left;">触发时机</th></tr></thead><tbody><tr><td style="text-align:center;">abort</td><td style="text-align:left;">当音频/视频的加载已放弃时</td></tr><tr><td style="text-align:center;">canplay</td><td style="text-align:left;">当浏览器可以播放音频/视频时</td></tr><tr><td style="text-align:center;">canplaythrough</td><td style="text-align:left;">当浏览器可在不因缓冲而停顿的情况下进行播放时</td></tr><tr><td style="text-align:center;">durationchange</td><td style="text-align:left;">当音频/视频的时长已更改时</td></tr><tr><td style="text-align:center;">emptied</td><td style="text-align:left;">当目前的播放列表为空时</td></tr><tr><td style="text-align:center;">ended</td><td style="text-align:left;">当目前的播放列表已结束时</td></tr><tr><td style="text-align:center;">error</td><td style="text-align:left;">当在音频/视频加载期间发生错误时</td></tr><tr><td style="text-align:center;">loadeddata</td><td style="text-align:left;">当浏览器已加载音频/视频的当前帧时</td></tr><tr><td style="text-align:center;">loadedmetadata</td><td style="text-align:left;">当浏览器已加载音频/视频的元数据时</td></tr><tr><td style="text-align:center;">loadstart</td><td style="text-align:left;">当浏览器开始查找音频/视频时</td></tr><tr><td style="text-align:center;">pause</td><td style="text-align:left;">当音频/视频已暂停时</td></tr><tr><td style="text-align:center;">play</td><td style="text-align:left;">当音频/视频已开始或不再暂停时</td></tr><tr><td style="text-align:center;">playing</td><td style="text-align:left;">当音频/视频在已因缓冲而暂停或停止后已就绪时</td></tr><tr><td style="text-align:center;">progress</td><td style="text-align:left;">当浏览器正在下载音频/视频时</td></tr><tr><td style="text-align:center;">ratechange</td><td style="text-align:left;">当音频/视频的播放速度已更改时</td></tr><tr><td style="text-align:center;">seeked</td><td style="text-align:left;">当用户已移动/跳跃到音频/视频中的新位置时</td></tr><tr><td style="text-align:center;">seeking</td><td style="text-align:left;">当用户开始移动/跳跃到音频/视频中的新位置时</td></tr><tr><td style="text-align:center;">stalled</td><td style="text-align:left;">当浏览器尝试获取媒体数据，但数据不可用时</td></tr><tr><td style="text-align:center;">suspend</td><td style="text-align:left;">当浏览器刻意不获取媒体数据时</td></tr><tr><td style="text-align:center;">timeupdate</td><td style="text-align:left;">当目前的播放位置已更改时</td></tr><tr><td style="text-align:center;">volumechange</td><td style="text-align:left;">当音量已更改时</td></tr><tr><td style="text-align:center;">waiting</td><td style="text-align:left;">当视频由于需要缓冲下一帧而停止</td></tr></tbody></table><h4 id="_4-事件捕捉示例" tabindex="-1"><a class="header-anchor" href="#_4-事件捕捉示例" aria-hidden="true">#</a> 4. 事件捕捉示例</h4><p>在播放过程中会经常触发timeupdate 事件來通知当前播放位置的改变，我们捕捉这个 timeupdate 事件来显示当前的播放进度</p><ul><li>currentTime 属性设置或返回音频/视频播放的当前位置（以秒计）。当设置该属性时，播放会跳跃到指定的位置</li><li>duration 属性返回当前音频/视频的长度，以秒计</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">playOrPauseVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;video1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    playButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;playButton&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vtime <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>paused<span class="token punctuation">)</span><span class="token punctuation">{</span>
        video<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        playButton<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;暂停&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        video<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        playButton<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;播放&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    video<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;timeupdate&#39;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        vtime<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span>
                <span class="token punctuation">(</span>video<span class="token punctuation">.</span>currentTime<span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span>video<span class="token punctuation">.</span>duration<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;%&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">===</span><span class="token operator">==</span>
<span class="token operator">&lt;</span>video src<span class="token operator">=</span><span class="token string">&quot;../../public/video/movie.mp4&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;400px&quot;</span> height<span class="token operator">=</span><span class="token string">&quot;400px&quot;</span>
     id<span class="token operator">=</span><span class="token string">&quot;video1&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>video<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;播放&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;playOrPauseVideo()&quot;</span> 
    id<span class="token operator">=</span><span class="token string">&quot;playButton&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">&quot;time&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,33),o=[e];function l(c,i){return a(),s("div",null,o)}const r=n(p,[["render",l],["__file","6-3.方法与事件.html.vue"]]);export{r as default};
