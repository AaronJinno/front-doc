---
title: 5-1. 模块化介绍
date: 2023-06-02
---
#### 1. 什么是模块化
模块化是指将一个大的程序文件，拆分成许多小的文件，然后将小文件组合起来。块的内部数据/实现是私有的, 只是向外部暴露一些接口(方法)与外部其它模块通信。

模块的组成：
- 数据--->内部的属性
- 操作数据的行为--->内部的函数

#### 2. 为什么要模块化
随着代码量的增加，会渐渐出现很多问题。冗余、结构复杂，难以部署等，因此我们需要将代码按照功能写到不同的JS文件中，每个文件就是一个模块。

这是最基本的模块化，这种模块化还是会有很多问题，比如：命名冲突、各个JS文件间的依赖性等。这就需要JS的模块化规范了。

#### 3. 模块化的优点
- 避免命名冲突
- 更好的分离，按需加载
- 更高复用性
- 高可维护性

#### 4. 页面引入多个JS文件的问题
当一个页面引入多个JS文件的时候，会产生很多问题。比如：
- 请求过多
- 依赖模糊：JS有先后顺序的
- 难以维护
这些问题可以通过模块化编码和项目构建来解决

#### 5. 模块化的规范
常见的模块化规范有：
- CommonJS：主要用于NodeJS环境
- Modules：ES6标准模块化规范
- AMD：不常用
- CMD：不常用

#### 6. JS模块化的历史

##### 6.1 全局function模式
最早是直接在全局function中写代码的，这种方法会污染Global，很容易命名冲突

##### 6.2 namespace模式
为了防止污染Global，将代码按照功能封装到对象中，使用的时候，直接 object.fun；
这种方法减少了Global上的变量数目，但是直接操纵对象，数据不安全，因为对象不仅可以读数据，还可以改数据。

##### 6.3 IIFE模式
将数据和行为封装到一个函数内部, 通过给window添加属性来向外暴露接口。
数据是私有的, 外部只能通过暴露的方法操作
```js
(function(window){
    let msg = "module1",
    function foo(){
        console.log(msg);
    }
    window.module1 = {foo}//我们是可以直接读到window的属性的
})(window);

//其他位置，直接读取
module1.foo();
```

##### 6.4 IIFE模式增强
在IEFE模式中引入依赖，这就是模块模式，也是现代模块实现的基石。
```js
(function(window,$){
    let msg = "module2"
    function foo(){
        console.log(msg);
    }
    window.module4 = foo;
    $('body').css('background','red');
})(window,jQuery);
```
