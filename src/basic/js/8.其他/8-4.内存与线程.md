---
title: 8-4. 内存与线程
date: 2023-05-14
---
## Ⅰ. 内存
#### 1. 数据
存在于内存中可读，可操纵的东西，一切皆数据，函数也是数据。
内存存在的意义，就是对数据进行操作。
#### 2. 内存
- 内存条的空间：内存条通电后产生的存储空间(临时的)就是内存，内存是临时性的储存，是有声明周期的。
- 内存的声明周期：内存条==》通电==》产生内存空间==》储存数据==》断电==》内存空间和数据都消失
- 内存储存的数据类型
    - 数据：直接储存数据【普通类型】
    - 内存地址：储存其他内存块的地址【引用类型】。
- 内存空间的分类
    - 栈：全局变量和局部变量的值和对象的地址储存在这里。
    - 堆：对象储存在这里。

#### 3. 变量值
值的标识符，该标识符是可变的，就称为变量。
一个变量对应一小块内存，他的值保存在内存中，即内存中的`数据==变量的值`

#### 4. 变量名
内存中储存的是变量的值，变量的名是不会储存的，变量的名可以理解为内存的地址标识。

变量名是给我们程序员操作内存来使用的。比如我们定义了一个全局的int a;那么编译器都为我们做了什么呢？它会为程序预留4个字节的空间（假设在32位平台），并把我们的变量名“a”保存进符号表，并用这个符号表的索引对应实际的空间。这是写编译器需要做的，我们需要建立符号表。变量名编译后，变成一个内存地址，这个内存地址一般是直接存在于代码段中


#### 5. 内存、数据、变量间的关系
内存是容器, 用来存储不同数据；

变量是内存的标识, 通过变量我们可以操作(读/写)内存中的数据；

#### 6. 垃圾回收GC
就像人生活的事件长了会产生垃圾一样，程序运行过程总也会产生垃圾，这些垃圾积攒过多以后，会导致程序运行的速度过慢，所以我们需要一个垃圾回收的机制，来处理程序运行过程中产生的垃圾。

当一个对象，没有任何的变量或属性对它进行引用，此时我们将永远无法操作该对象，此时这种对象就是一个垃圾。这种对象过多，会占用大量的内存空间，导致程序运行过慢，所以需要进行清理。

JS中拥有自动的垃圾回收机制，会自动将这些垃圾对象从内存中销毁，我们不需要也不能进行垃圾回收的操作。将对象变成垃圾，我们需要做的只是将不在使用的对象设置为null。


#### 7. 内存溢出与泄露
##### 7.1 溢出
一种程序运行出现的错误，当程序运行需要的内存超过了剩余的内存时, 就出抛出内存溢出的错误。

##### 7.2 泄露
占用的内存没有及时释放，泄露积累多了就容易导致内存溢出。

常见的内存泄露
- 意外的全局变量
- 没有及时清理的计时器或回调函数
- 闭包


## Ⅱ. 进程与线程
#### 1. 进程
程序的一次执行, 它占有一片独有的内存空间

可以通过windows任务管理器查看进程
#### 2. 线程
- 是进程内的一个独立执行单元
- 是程序执行的一个完整流程
- 是CPU的最小的调度单元

#### 3. 进行与线程的关系
一个进程至少有一个线程(主)。

程序是在某个进程中的某个线程执行的。

#### 4. JS线程
- js是单线程执行的(回调函数也是在主线程)
- H5提出了实现多线程的方案: Web Workers
- 只能是主线程更新界面

## Ⅲ. 浏览器内核
#### 1. 主线程
- js引擎模块 : 负责js程序的编译与运行
- html,css文档解析模块 : 负责页面文本的解析
- DOM/CSS模块 : 负责dom/css在内存中的相关处理 
- 布局和渲染模块 : 负责页面的布局和效果的绘制(内存中的对象)

#### 2. 分线程
- 定时器模块 : 负责定时器的管理
- DOM事件模块 : 负责事件的管理
- 网络请求模块 : 负责Ajax请求

